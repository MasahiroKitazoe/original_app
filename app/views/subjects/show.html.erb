            <div>
              <header>
                <h2>
                  <%= @subject.name %>
                </h2>
                  <% if @subject.reviews.present? %>
                    <span class="rate rate<%= (@subject.reviews.average(:rate).round(1) * 10).floor %>"></span>
                  <% end %>
              </header>
              <div style="text-align: right">
                <a href="/subjects/<%= @subject.id %>/reviews/new">この被写体の評価をする</a>
              </div>


            <P>
              MAP
            </P>

            <div style='width: 800px;'>
              <div id="map" style='width: 800px; height: 400px;'></div>
            </div>

            <script type="text/javascript">
                handler = Gmaps.build('Google');
                handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
                  markers = handler.addMarkers(<%=raw @hash.to_json %>);
                  handler.bounds.extendWith(markers);
                  handler.fitMapToBounds();
                  handler.getMap().setCenter(new google.maps.LatLng(<%= @map.latitude %>, <%= @map.longitude %>));
                  handler.getMap().setZoom(15);
                });
            </script>


              <header>
                <h2>
                  みんなのレビュー
                </h2>
              </header>
              <% if @subject.reviews.present? %>
              <ul style="padding: 0">
                <% @subject.reviews.each do |review| %>
                  <li style="border-bottom: dotted 1px">
                      <h3>
                        <%= review.user.nickname %>
                      </h3>
                      <span class="rate rate<%= review.rate %>0"></span>
                      <p>
                        <%= review.comment %>
                      </p>
                        <% review.images.each do |image| %>
                          <% if image.image_file.present? %>
                            <%= image_tag image.image_file.url %>

                              <%= render partial: "like", locals: {image: image, review: review} %>

                          <!-- image_file.present?の閉じタグ -->
                          <% end %>

                            <br>

                        <!-- review.images.eachの閉じタグ -->
                        <% end %>

                  </li>

                <!-- @subject.reviews.eachの閉じタグ -->
                <% end %>

              </ul>

              <!-- レビューがまだ存在しない場合 -->
              <% else %>
                <p>
                  まだレビューはありません
                </p>
              <% end %>
            </div>